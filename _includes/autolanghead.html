<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>{{page.lang}}  {% if page.title %}{{ page.title | escape }}{% else %}{{ site.title[page.lang] | escape }}{% endif %}</title>
  <meta name="description"
    content="{% if page.excerpt %}{{ page.excerpt | strip_html | strip_newlines | truncate: 160 }}{% else %}{{ site.description[page.lang] }}{% endif %}">
  
  <script lang="text/javascript">
    function detectLang() {
      var langs = "{{site.langs}}".split(",");
      if (window.localStorage && localStorage.getItem("lang") && langs.indexOf(localStorage.getItem("lang")) != -1) {
        gotoLang (localStorage.getItem("lang"));
        return;
      }
      var language = window.navigator.userLanguage || window.navigator.language;
      for (var lang in langs) {
        lang = langs[lang];
        if (language.indexOf(lang + "-")) {
          gotoLang (lang);
          return;
        }
      }
      gotoLang ("en");
    }
    function gotoLang(language){
      console.log(language);
      var hasLangInUrl = false;
      var baseurl = "{{site.baseurl}}";
      var langs = "{{site.langs}}".split(",");
      for (var lang in langs) {
        lang = langs[lang];
        hasLangInUrl = (location.pathname.indexOf(baseurl + "/" + lang)==0);
        console.log(lang)
        console.log(hasLangInUrl)
        if(hasLangInUrl){
          break;
        }
      }
      if(!hasLangInUrl){
        location.href = baseurl + "/" + language + location.pathname 
            + (location.search ? "?" + location.search :"");
      }
    }
    detectLang();
  </script>
  <link rel="stylesheet" href="{{ "/css/main.css" | prepend: site.baseurl }}">
  <link rel="canonical" href="{{ page.url | replace:'index.html','' | prepend: site.baseurl | prepend: site.url }}">
  {% assign posts=site.posts | where:"ref", page.ref | sort: 'lang' %}{% for post in posts %}
  <link rel="alternate" hreflang="{{ post.lang }}" href="{{ post.url }}" />{% endfor %}
  {% assign pages=site.pages | where:"ref", page.ref | sort: 'lang' %}{% for page in pages %}
  <link rel="alternate" hreflang="{{ page.lang }}" href="{{ page.url }}" />{% endfor %}
  <link rel="alternate" type="application/rss+xml" title="{{ site.title[page.lang] }}"
    href="{{ site.feed[page.lang] | prepend: site.baseurl | prepend: site.url }}">
</head>